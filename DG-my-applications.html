<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¨ê° - ë‚´ í™œë™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .back-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #f0f0f0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2d5a27;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .logo::before {
            content: "ğŸŠ";
            font-size: 2rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #2d5a27;
            color: white;
        }

        .btn-primary:hover {
            background: #1e3d1a;
            transform: translateY(-2px);
        }

        .btn-outline {
            border: 2px solid #2d5a27;
            color: #2d5a27;
            background: transparent;
        }

        .btn-outline:hover {
            background: #2d5a27;
            color: white;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Page Header */
        .page-header {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .page-title {
            font-size: 1.8rem;
            color: #2d5a27;
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: #666;
            margin-bottom: 1.5rem;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #2d5a27, #4a7c59);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .stat-card.pending {
            background: linear-gradient(135deg, #ffc107, #ffca2c);
            color: #333;
        }

        .stat-card.approved {
            background: linear-gradient(135deg, #28a745, #34ce57);
        }

        .stat-card.rejected {
            background: linear-gradient(135deg, #dc3545, #e4606d);
        }

        /* Tab Navigation */
        .tab-navigation {
            background: white;
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .tab-buttons {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: #666;
            border-radius: 8px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab-btn.active {
            background: #2d5a27;
            color: white;
        }

        .tab-btn:hover {
            background: #f0f0f0;
        }

        .tab-btn.active:hover {
            background: #1e3d1a;
        }

        /* Filter Bar */
        .filter-bar {
            background: white;
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-select {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: #2d5a27;
        }

        /* Applications List */
        .applications-section {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }

        .results-count {
            color: #666;
            font-size: 0.9rem;
        }

        .sort-options {
            display: flex;
            gap: 0.5rem;
        }

        .sort-btn {
            padding: 0.4rem 0.8rem;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .sort-btn.active {
            background: #2d5a27;
            color: white;
            border-color: #2d5a27;
        }

        /* Application Items */
        .application-item {
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .application-item:hover {
            border-color: #2d5a27;
            box-shadow: 0 5px 15px rgba(45, 90, 39, 0.1);
            transform: translateY(-2px);
        }

        .application-item:last-child {
            margin-bottom: 0;
        }

        .application-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .work-info h3 {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .work-meta {
            display: flex;
            gap: 1rem;
            align-items: center;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .work-category {
            background: #e8f5e8;
            color: #2d5a27;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .application-status {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.5rem;
        }

        .status-badge {
            padding: 0.4rem 1rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            min-width: 80px;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-completed {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .application-time {
            font-size: 0.8rem;
            color: #999;
        }

        .application-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .application-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid #f0f0f0;
        }

        .payment-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .payment-amount {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d5a27;
        }

        .work-date {
            color: #666;
            font-size: 0.9rem;
        }

        .application-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Messages */
        .message-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #f0f0f0;
        }

        .message-item {
            background: #f8f9fa;
            border-left: 3px solid #2d5a27;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border-radius: 0 8px 8px 0;
        }

        .message-from {
            font-weight: 600;
            color: #2d5a27;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
        }

        .message-content {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .message-time {
            font-size: 0.8rem;
            color: #999;
            margin-top: 0.3rem;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #666;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .empty-description {
            margin-bottom: 2rem;
        }

        /* Notification Dot */
        .notification-dot {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 12px;
            height: 12px;
            background: #dc3545;
            border-radius: 50%;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .application-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .application-status {
                align-items: flex-start;
            }
            
            .work-meta {
                flex-wrap: wrap;
            }
            
            .filter-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-input {
                min-width: unset;
            }
            
            .tab-buttons {
                justify-content: center;
            }
            
            .application-footer {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
        }

        .urgent-indicator {
            background: #dc3545;
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .rating-section {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .rating-stars {
            color: #ffc107;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .rating-comment {
            color: #555;
            font-style: italic;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="back-btn" onclick="goBack()">â†</button>
            <a href="#" class="logo">ë‹¨ê°</a>
        </div>
        <div class="header-actions">
            <a href="#" class="btn btn-outline">ì¼ê±°ë¦¬ ì°¾ê¸°</a>
            <a href="#" class="btn btn-primary">+ ì‘ì—… ë“±ë¡</a>
        </div>
    </header>

    <div class="container">
        <!-- Page Header with Stats -->
        <div class="page-header">
            <h1 class="page-title">ë‚´ í™œë™</h1>
            <p class="page-subtitle">ì§€ì›í•œ ì‘ì—…ê³¼ ìš”ì²­í•œ ì‘ì—…ì„ í•œëˆˆì— ê´€ë¦¬í•˜ì„¸ìš”</p>
            
            <div class="stats-grid">
                <div class="stat-card pending">
                    <div class="stat-number">7</div>
                    <div class="stat-label">ëŒ€ê¸°ì¤‘ì¸ ì§€ì›</div>
                </div>
                <div class="stat-card approved">
                    <div class="stat-number">23</div>
                    <div class="stat-label">ìŠ¹ì¸ëœ ì‘ì—…</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">156,000</div>
                    <div class="stat-label">ì´ë²ˆ ë‹¬ ìˆ˜ì… (ì›)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4.9</div>
                    <div class="stat-label">í‰ê·  í‰ì </div>
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="applications">ë‚´ê°€ ì§€ì›í•œ ì‘ì—…</button>
                <button class="tab-btn" data-tab="requests">ë‚´ê°€ ë“±ë¡í•œ ì‘ì—…</button>
                <button class="tab-btn" data-tab="completed">ì™„ë£Œëœ ì‘ì—…</button>
                <button class="tab-btn" data-tab="saved">ì €ì¥í•œ ì‘ì—…</button>
            </div>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-group">
                <label>ìƒíƒœ:</label>
                <select class="filter-select" id="statusFilter">
                    <option value="">ì „ì²´</option>
                    <option value="pending">ëŒ€ê¸°ì¤‘</option>
                    <option value="approved">ìŠ¹ì¸</option>
                    <option value="rejected">ê±°ì ˆ</option>
                    <option value="completed">ì™„ë£Œ</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>ë¶„ì•¼:</label>
                <select class="filter-select" id="categoryFilter">
                    <option value="">ì „ì²´</option>
                    <option value="rice">ë…¼ë†ì‚¬</option>
                    <option value="field">ë°­ë†ì‚¬</option>
                    <option value="fruit">ê³¼ìˆ˜ì›</option>
                    <option value="livestock">ì¶•ì‚°ì—…</option>
                    <option value="facility">ì‹œì„¤ê´€ë¦¬</option>
                </select>
            </div>
            
            <input type="text" class="search-input" placeholder="ì‘ì—… ì œëª©, ì§€ì—­ìœ¼ë¡œ ê²€ìƒ‰..." id="searchInput">
            <button class="btn btn-primary btn-small" onclick="searchApplications()">ê²€ìƒ‰</button>
        </div>

        <!-- Applications Section -->
        <div class="applications-section">
            <div class="section-header">
                <div class="results-count">ì´ <strong>12</strong>ê°œì˜ ì§€ì›</div>
                <div class="sort-options">
                    <button class="sort-btn active" data-sort="recent">ìµœì‹ ìˆœ</button>
                    <button class="sort-btn" data-sort="status">ìƒíƒœìˆœ</button>
                    <button class="sort-btn" data-sort="date">ì‘ì—…ì¼ìˆœ</button>
                </div>
            </div>

            <div class="applications-list" id="applicationsList">
                <!-- ì§€ì› ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        // ìƒ˜í”Œ ë°ì´í„°
        const sampleApplications = [
            {
                id: 1,
                title: "ë²¼ ìˆ˜í™• ì‘ì—… (ì½¤ë°”ì¸ ë³´ìœ ì ìš°ëŒ€)",
                category: "ë…¼ë†ì‚¬",
                location: "ì „ë¶ ì™„ì£¼êµ° ê³ ì‚°ë©´",
                employer: "ê¹€ë†ë¶€",
                price: "180,000",
                priceType: "ì¼ë‹¹",
                status: "approved",
                appliedAt: "2025-09-04T08:30:00",
                workDate: "2025-09-06",
                urgent: true,
                description: "ì•½ 3ë§Œí‰ ê·œëª¨ì˜ ë²¼ë…¼ì—ì„œ ìˆ˜í™• ì‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤. ì½¤ë°”ì¸ì„ ë³´ìœ í•˜ì‹  ë¶„ì„ ìš°ëŒ€í•©ë‹ˆë‹¤.",
                hasMessage: true,
                message: {
                    from: "ê¹€ë†ë¶€",
                    content: "ë‚´ì¼ ì˜¤ì „ 6ì‹œì— í˜„ì¥ì—ì„œ ë§Œë‚˜ëµ™ê² ìŠµë‹ˆë‹¤. ì‘ì—…ë³µê³¼ ë„ì‹œë½ì„ ì¤€ë¹„í•´ ì£¼ì„¸ìš”.",
                    time: "1ì‹œê°„ ì „"
                }
            },
            {
                id: 2,
                title: "ë”¸ê¸°ë°­ ì •ë¦¬ ë° ëª¨ì¢… ì‹¬ê¸°",
                category: "ë°­ë†ì‚¬",
                location: "ì „ë¶ ì „ì£¼ì‹œ ë•ì§„êµ¬",
                employer: "ì´ë†ì¥",
                price: "15,000",
                priceType: "ì‹œê¸‰",
                status: "pending",
                appliedAt: "2025-09-03T14:20:00",
                workDate: "2025-09-07",
                urgent: false,
                description: "ê²¨ìš¸ì²  ë”¸ê¸° ì¬ë°°ë¥¼ ìœ„í•œ ë°­ ì •ë¦¬ì™€ ëª¨ì¢… ì‹¬ê¸° ì‘ì—…ì…ë‹ˆë‹¤.",
                hasMessage: false
            },
            {
                id: 3,
                title: "ì¶•ì‚¬ ì²­ì†Œ ë° ì‚¬ë£Œ ë°°ê¸‰",
                category: "ì¶•ì‚°ì—…",
                location: "ì „ë¶ ì§„ì•ˆêµ° ë§ˆë ¹ë©´",
                employer: "ë°•ëª©ì¥",
                price: "120,000",
                priceType: "ì¼ë‹¹",
                status: "rejected",
                appliedAt: "2025-09-02T16:45:00",
                workDate: "2025-09-10",
                urgent: false,
                description: "í•œìš° 60ë‘ ê·œëª¨ ì¶•ì‚¬ì˜ ì¼ì¼ ê´€ë¦¬ ì—…ë¬´ì…ë‹ˆë‹¤.",
                hasMessage: true,
                message: {
                    from: "ë°•ëª©ì¥",
                    content: "ì£„ì†¡í•©ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ì¶•ì‚° ê²½í—˜ì´ ìˆëŠ” ë¶„ìœ¼ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ê¸°íšŒì— ë‹¤ì‹œ ì§€ì›í•´ ì£¼ì„¸ìš”.",
                    time: "2ì¼ ì „"
                }
            },
            {
                id: 4,
                title: "ì‚¬ê³¼ ìˆ˜í™• ë„ìš°ë¯¸",
                category: "ê³¼ìˆ˜ì›",
                location: "ì „ë¶ ì„ì‹¤êµ° ê´€ì´Œë©´",
                employer: "ìµœê³¼ìˆ˜ì›",
                price: "13,000",
                priceType: "ì‹œê¸‰",
                status: "completed",
                appliedAt: "2025-08-28T09:10:00",
                workDate: "2025-08-30",
                urgent: false,
                description: "ì‚¬ê³¼ ìˆ˜í™•ì² ì„ ë§ì•„ ê³¼ìˆ˜ì›ì—ì„œ ì‚¬ê³¼ ë”°ê¸° ì‘ì—…ì„ ë„ì™€ì£¼ì‹¤ ë¶„ì„ ì°¾ìŠµë‹ˆë‹¤.",
                hasMessage: false,
                rating: 5,
                review: "ì„±ì‹¤í•˜ê²Œ ì¼í•´ì£¼ì…”ì„œ ê°ì‚¬í–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒì—ë„ ë˜ ë¶€íƒë“œë¦¬ê³  ì‹¶ìŠµë‹ˆë‹¤."
            },
            {
                id: 5,
                title: "ë¹„ë‹í•˜ìš°ìŠ¤ ë³´ìˆ˜ ì‘ì—…",
                category: "ì‹œì„¤ê´€ë¦¬",
                location: "ì „ë¶ ë¬´ì£¼êµ° ì„¤ì²œë©´",
                employer: "ì •ë†ì›",
                price: "200,000",
                priceType: "ì´ì•¡",
                status: "pending",
                appliedAt: "2025-09-01T11:30:00",
                workDate: "í˜‘ì˜",
                urgent: false,
                description: "ê²¨ìš¸ì²  ëŒ€ë¹„ ë¹„ë‹í•˜ìš°ìŠ¤ ë³´ìˆ˜ ì‘ì—…ì…ë‹ˆë‹¤.",
                hasMessage: true,
                message: {
                    from: "ì •ë†ì›",
                    content: "ì§€ì›í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë‹¤ë¥¸ ì§€ì›ìë“¤ê³¼ í•¨ê»˜ ê²€í†  ì¤‘ì…ë‹ˆë‹¤.",
                    time: "3ì¼ ì „"
                }
            }
        ];

        // ìƒíƒœë³„ í•œê¸€ ë§¤í•‘
        const statusMap = {
            'pending': 'ëŒ€ê¸°ì¤‘',
            'approved': 'ìŠ¹ì¸ë¨',
            'rejected': 'ê±°ì ˆë¨',
            'completed': 'ì™„ë£Œë¨'
        };

        // ì¹´í…Œê³ ë¦¬ í•œì˜ ë§¤í•‘
        const categoryMap = {
            "ë…¼ë†ì‚¬": "rice",
            "ë°­ë†ì‚¬": "field", 
            "ê³¼ìˆ˜ì›": "fruit",
            "ì¶•ì‚°ì—…": "livestock",
            "ì‹œì„¤ê´€ë¦¬": "facility"
        };

        // ì§€ì› í•­ëª© ë Œë”ë§
        function renderApplications(applications) {
            const container = document.getElementById('applicationsList');
            
            if (applications.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“</div>
                        <h3 class="empty-title">ì§€ì›í•œ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p class="empty-description">ìƒˆë¡œìš´ ì¼ê±°ë¦¬ë¥¼ ì°¾ì•„ë³´ì„¸ìš”!</p>
                        <a href="#" class="btn btn-primary">ì¼ê±°ë¦¬ ì°¾ê¸°</a>
                    </div>
                `;
                return;
            }

            container.innerHTML = applications.map(app => `
                <div class="application-item" onclick="viewApplicationDetail(${app.id})">
                    ${app.hasMessage ? '<div class="notification-dot"></div>' : ''}
                    
                    <div class="application-header">
                        <div class="work-info">
                            <h3>
                                ${app.title}
                                ${app.urgent ? '<span class="urgent-indicator">ê¸´ê¸‰</span>' : ''}
                            </h3>
                            <div class="work-meta">
                                <div class="meta-item">ğŸ“ ${app.location}</div>
                                <div class="meta-item">ğŸ‘¨â€ğŸŒ¾ ${app.employer}</div>
                                <div class="meta-item">ğŸ“… ${app.workDate}</div>
                            </div>
                            <div class="work-category">${app.category}</div>
                        </div>
                        <div class="application-status">
                            <div class="status-badge status-${app.status}">
                                ${statusMap[app.status]}
                            </div>
                            <div class="application-time">${formatTime(app.appliedAt)} ì§€ì›</div>
                        </div>
                    </div>
                    
                    <div class="application-description">${app.description}</div>
                    
                    ${app.hasMessage ? `
                        <div class="message-section">
                            <div class="message-item">
                                <div class="message-from">${app.message.from}ë‹˜ì˜ ë©”ì‹œì§€</div>
                                <div class="message-content">${app.message.content}</div>
                                <div class="message-time">${app.message.time}</div>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${app.rating ? `
                        <div class="rating-section">
                            <div class="rating-stars">${'â˜…'.repeat(app.rating)}${'â˜†'.repeat(5-app.rating)}</div>
                            <div class="rating-comment">"${app.review}"</div>
                        </div>
                    ` : ''}
                    
                    <div class="application-footer">
                        <div class="payment-info">
                            <span class="payment-amount">${parseInt(app.price).toLocaleString()}ì›</span>
                            <span class="work-date">${app.priceType}</span>
                        </div>
                        <div class="application-actions">
                            ${getActionButtons(app.status, app.id)}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ìƒíƒœë³„ ì•¡ì…˜ ë²„íŠ¼
        function getActionButtons(status, id) {
            switch(status) {
                case 'pending':
                    return `
                        <button class="btn btn-outline btn-small" onclick="cancelApplication(${id}, event)">ì§€ì› ì·¨ì†Œ</button>
                        <button class="btn btn-primary btn-small" onclick="sendMessage(${id}, event)">ë©”ì‹œì§€</button>
                    `;
                case 'approved':
                    return `
                        <button class="btn btn-primary btn-small" onclick="sendMessage(${id}, event)">ë©”ì‹œì§€</button>
                    `;
                case 'rejected':
                    return `
                        <button class="btn btn-outline btn-small" onclick="deleteApplication(${id}, event)">ì‚­ì œ</button>
                    `;
                case 'completed':
                    return `
                        <button class="btn btn-outline btn-small" onclick="writeReview(${id}, event)">ë¦¬ë·° ì‘ì„±</button>
                    `;
                default:
                    return '';
            }
        }

        // ì‹œê°„ í¬ë§·íŒ…
        function formatTime(timeString) {
            const date = new Date(timeString);
            const now = new Date();
            const diffInHours = Math.floor((now - date) / (1000 * 60 * 60));
            
            if (diffInHours < 1) return 'ë°©ê¸ˆ ì „';
            if (diffInHours < 24) return `${diffInHours}ì‹œê°„ ì „`;
            
            const diffInDays = Math.floor(diffInHours / 24);
            if (diffInDays < 7) return `${diffInDays}ì¼ ì „`;
            
            return date.toLocaleDateString();
        }

        // í•„í„°ë§ í•¨ìˆ˜
        function filterApplications() {
            const statusFilter = document.getElementById('statusFilter').value;
            const categoryFilter = document.getElementById('categoryFilter').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            let filtered = sampleApplications;
            
            // ìƒíƒœ í•„í„°
            if (statusFilter) {
                filtered = filtered.filter(app => app.status === statusFilter);
            }
            
            // ì¹´í…Œê³ ë¦¬ í•„í„°
            if (categoryFilter) {
                filtered = filtered.filter(app => categoryMap[app.category] === categoryFilter);
            }
            
            // ê²€ìƒ‰ì–´ í•„í„°
            if (searchTerm) {
                filtered = filtered.filter(app => 
                    app.title.toLowerCase().includes(searchTerm) ||
                    app.location.toLowerCase().includes(searchTerm) ||
                    app.employer.toLowerCase().includes(searchTerm)
                );
            }
            
            return filtered;
        }

        // ì •ë ¬ í•¨ìˆ˜
        function sortApplications(applications, sortBy) {
            const sorted = [...applications];
            
            switch(sortBy) {
                case 'recent':
                    return sorted.sort((a, b) => new Date(b.appliedAt) - new Date(a.appliedAt));
                case 'status':
                    const statusOrder = ['approved', 'pending', 'rejected', 'completed'];
                    return sorted.sort((a, b) => statusOrder.indexOf(a.status) - statusOrder.indexOf(b.status));
                case 'date':
                    return sorted.sort((a, b) => new Date(a.workDate) - new Date(b.workDate));
                default:
                    return sorted;
            }
        }

        // ì§€ì› ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateApplicationsList() {
            const filtered = filterApplications();
            const sortBy = document.querySelector('.sort-btn.active').dataset.sort;
            const sorted = sortApplications(filtered, sortBy);
            renderApplications(sorted);
            
            // ê²°ê³¼ ìˆ˜ ì—…ë°ì´íŠ¸
            document.querySelector('.results-count').innerHTML = 
                `ì´ <strong>${sorted.length}</strong>ê°œì˜ ì§€ì›`;
        }

        // ê²€ìƒ‰ í•¨ìˆ˜
        function searchApplications() {
            updateApplicationsList();
        }

        // ì§€ì› ìƒì„¸ ë³´ê¸°
        function viewApplicationDetail(id) {
            alert(`ì§€ì› ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. (ID: ${id})`);
            // window.location.href = `DG-work-detail.html?id=${workId}`;
        }

        // ì§€ì› ì·¨ì†Œ
        function cancelApplication(id, event) {
            event.stopPropagation();
            
            if (confirm('ì •ë§ë¡œ ì§€ì›ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                alert('ì§€ì›ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                // ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ì„œë²„ API í˜¸ì¶œ
                updateApplicationsList();
            }
        }

        // ë©”ì‹œì§€ ë³´ë‚´ê¸°
        function sendMessage(id, event) {
            event.stopPropagation();
            alert('ë©”ì‹œì§€ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
            // window.location.href = `DG-chat-room.html?application=${id}`;
        }

        // ì§€ì› ì‚­ì œ
        function deleteApplication(id, event) {
            event.stopPropagation();
            
            if (confirm('ì´ ì§€ì› ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                alert('ì§€ì› ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                updateApplicationsList();
            }
        }

        // ë¦¬ë·° ì‘ì„±
        function writeReview(id, event) {
            event.stopPropagation();
            alert('ë¦¬ë·° ì‘ì„± í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
            // window.location.href = `DG-write-review.html?application=${id}`;
        }

        // ë’¤ë¡œê°€ê¸°
        function goBack() {
            window.history.back();
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        document.addEventListener('DOMContentLoaded', function() {
            // ì´ˆê¸° ë Œë”ë§
            renderApplications(sampleApplications);
            
            // íƒ­ ë²„íŠ¼ í´ë¦­
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const tab = this.dataset.tab;
                    handleTabChange(tab);
                });
            });
            
            // ì •ë ¬ ë²„íŠ¼ í´ë¦­
            document.querySelectorAll('.sort-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updateApplicationsList();
                });
            });
            
            // í•„í„° ë³€ê²½
            document.getElementById('statusFilter').addEventListener('change', updateApplicationsList);
            document.getElementById('categoryFilter').addEventListener('change', updateApplicationsList);
            
            // ê²€ìƒ‰ Enter í‚¤
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchApplications();
                }
            });
        });

        // íƒ­ ë³€ê²½ ì²˜ë¦¬
        function handleTabChange(tab) {
            switch(tab) {
                case 'applications':
                    renderApplications(sampleApplications);
                    break;
                case 'requests':
                    alert('ë‚´ê°€ ë“±ë¡í•œ ì‘ì—… í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                    // window.location.href = 'DG-my-requests.html';
                    break;
                case 'completed':
                    const completed = sampleApplications.filter(app => app.status === 'completed');
                    renderApplications(completed);
                    break;
                case 'saved':
                    alert('ì €ì¥í•œ ì‘ì—… í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                    break;
            }
        }

        // ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œë®¬ë ˆì´ì…˜
        function simulateNotifications() {
            if (Math.random() > 0.8) {
                // ìƒˆ ë©”ì‹œì§€ ì•Œë¦¼
                const randomApp = sampleApplications[Math.floor(Math.random() * sampleApplications.length)];
                if (!randomApp.hasMessage && randomApp.status === 'pending') {
                    randomApp.hasMessage = true;
                    randomApp.message = {
                        from: randomApp.employer,
                        content: "ìƒˆë¡œìš´ ë©”ì‹œì§€ê°€ ë„ì°©í–ˆìŠµë‹ˆë‹¤.",
                        time: "ë°©ê¸ˆ ì „"
                    };
                    updateApplicationsList();
                }
            }
        }

        // 30ì´ˆë§ˆë‹¤ ì•Œë¦¼ í™•ì¸
        setInterval(simulateNotifications, 30000);
    </script>
</body>
</html>