<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Îã®Í∞ê - ÏßÄÎèÑÏóêÏÑú ÏùºÍ±∞Î¶¨ Ï∞æÍ∏∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            background: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .back-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #f0f0f0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2d5a27;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .logo::before {
            content: "üçä";
            font-size: 2rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .view-toggle {
            display: flex;
            gap: 0.5rem;
        }

        .view-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .view-btn.active {
            background: #2d5a27;
            color: white;
            border-color: #2d5a27;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #2d5a27;
            color: white;
        }

        .btn-primary:hover {
            background: #1e3d1a;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        /* Search Bar */
        .search-bar {
            background: white;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: #2d5a27;
        }

        .filter-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-tag {
            padding: 0.5rem 1rem;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .filter-tag.active {
            background: #2d5a27;
            color: white;
            border-color: #2d5a27;
        }

        .location-btn {
            padding: 0.75rem;
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .location-btn:hover {
            background: #138496;
        }

        /* Main Container */
        .main-container {
            flex: 1;
            display: flex;
            min-height: 0;
        }

        /* Map Container */
        .map-container {
            flex: 1;
            position: relative;
            background: linear-gradient(45deg, #e8f5e8, #d4edda);
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid #ddd;
        }

        .map-placeholder {
            text-align: center;
            color: #666;
            font-size: 1.2rem;
        }

        .map-controls {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .map-control-btn {
            width: 40px;
            height: 40px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .map-control-btn:hover {
            background: #f8f9fa;
            border-color: #2d5a27;
        }

        /* Map Markers */
        .map-marker {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #2d5a27;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            cursor: pointer;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .map-marker:hover {
            transform: translate(-50%, -50%) scale(1.2);
            z-index: 10;
        }

        .map-marker.urgent {
            background: #dc3545;
            animation: pulse 2s infinite;
        }

        .map-marker.selected {
            background: #ffc107;
            transform: translate(-50%, -50%) scale(1.3);
            z-index: 10;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }

        /* Sidebar */
        .sidebar {
            width: 400px;
            background: white;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .results-count {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .sort-options {
            display: flex;
            gap: 0.5rem;
        }

        .sort-btn {
            padding: 0.3rem 0.8rem;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 15px;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .sort-btn.active {
            background: #2d5a27;
            color: white;
            border-color: #2d5a27;
        }

        .work-list {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        /* Work Items */
        .work-item {
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .work-item:hover {
            border-color: #2d5a27;
            background: #f8f9fa;
            transform: translateX(5px);
        }

        .work-item.selected {
            border-color: #ffc107;
            background: #fff8e1;
            box-shadow: 0 3px 10px rgba(255, 193, 7, 0.3);
        }

        .work-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .work-title {
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
            line-height: 1.3;
        }

        .work-distance {
            background: #e8f5e8;
            color: #2d5a27;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .work-meta {
            display: flex;
            gap: 1rem;
            align-items: center;
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.2rem;
        }

        .work-price {
            font-weight: bold;
            color: #2d5a27;
            font-size: 0.9rem;
        }

        .work-category {
            background: #f0f0f0;
            color: #666;
            padding: 0.2rem 0.5rem;
            border-radius: 8px;
            font-size: 0.8rem;
        }

        .urgent-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: #dc3545;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* Work Detail Popup */
        .work-popup {
            position: absolute;
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 350px;
            z-index: 100;
            transform: translate(-50%, -100%) translateY(-10px);
            border: 1px solid #ddd;
            display: none;
        }

        .work-popup.show {
            display: block;
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .popup-title {
            font-weight: 600;
            color: #333;
            line-height: 1.3;
        }

        .close-popup {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: #666;
            cursor: pointer;
            padding: 0.2rem;
        }

        .popup-content {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .popup-meta {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .popup-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Distance Rings */
        .distance-ring {
            position: absolute;
            border: 2px dashed #2d5a27;
            border-radius: 50%;
            opacity: 0.3;
            pointer-events: none;
        }

        .ring-5km {
            width: 200px;
            height: 200px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .ring-10km {
            width: 400px;
            height: 400px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Legend */
        .map-legend {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 0.8rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.3rem;
        }

        .legend-marker {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            border: 1px solid white;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }
            
            .search-bar {
                padding: 1rem;
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-input {
                min-width: unset;
                margin-bottom: 0.5rem;
            }
            
            .main-container {
                flex-direction: column;
            }
            
            .map-container {
                height: 50vh;
                border-right: none;
                border-bottom: 1px solid #ddd;
            }
            
            .sidebar {
                width: 100%;
                height: 50vh;
            }
            
            .work-popup {
                max-width: 300px;
                padding: 1rem;
            }
            
            .map-controls {
                bottom: 1rem;
                top: auto;
                right: 1rem;
                flex-direction: row;
            }
        }

        /* Loading State */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #666;
        }

        .loading::before {
            content: "üîÑ";
            font-size: 2rem;
            animation: spin 1s linear infinite;
            display: block;
            margin-bottom: 0.5rem;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Custom Scrollbar */
        .work-list::-webkit-scrollbar {
            width: 6px;
        }

        .work-list::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .work-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .work-list::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="back-btn" onclick="goBack()">‚Üê</button>
            <a href="#" class="logo">Îã®Í∞ê</a>
        </div>
        <div class="header-actions">
            <div class="view-toggle">
                <button class="view-btn" onclick="switchToList()">üìã Î™©Î°ù</button>
                <button class="view-btn active" onclick="switchToMap()">üó∫Ô∏è ÏßÄÎèÑ</button>
            </div>
            <a href="#" class="btn btn-primary btn-small">+ ÏûëÏóÖ Îì±Î°ù</a>
        </div>
    </header>

    <div class="search-bar">
        <input type="text" class="search-input" placeholder="ÏßÄÏó≠, ÏûëÏóÖ ÎÇ¥Ïö©ÏúºÎ°ú Í≤ÄÏÉâÌïòÏÑ∏Ïöî" id="searchInput">
        <div class="filter-tags">
            <div class="filter-tag" data-filter="all">Ï†ÑÏ≤¥</div>
            <div class="filter-tag active" data-filter="5km">5km Ïù¥ÎÇ¥</div>
            <div class="filter-tag" data-filter="urgent">Í∏¥Í∏â</div>
            <div class="filter-tag" data-filter="high-pay">Í≥†ÏàòÏùµ</div>
            <div class="filter-tag" data-filter="today">Ïò§Îäò</div>
        </div>
        <button class="location-btn" onclick="getCurrentLocation()">üìç ÎÇ¥ ÏúÑÏπò</button>
    </div>

    <div class="main-container">
        <div class="map-container" id="mapContainer">
            <div class="map-placeholder">
                <div>üó∫Ô∏è ÏßÄÎèÑÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§</div>
                <div style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.7;">
                    (Ïπ¥Ïπ¥Ïò§Îßµ ÎòêÎäî ÎÑ§Ïù¥Î≤ÑÏßÄÎèÑ API Ïó∞Îèô)
                </div>
            </div>

            <!-- Distance Rings -->
            <div class="distance-ring ring-5km"></div>
            <div class="distance-ring ring-10km"></div>

            <!-- Sample Map Markers -->
            <div class="map-marker urgent" style="top: 30%; left: 40%;" data-work-id="1" onclick="selectWork(1)">1</div>
            <div class="map-marker" style="top: 60%; left: 30%;" data-work-id="2" onclick="selectWork(2)">2</div>
            <div class="map-marker" style="top: 45%; left: 70%;" data-work-id="3" onclick="selectWork(3)">3</div>
            <div class="map-marker urgent" style="top: 70%; left: 60%;" data-work-id="4" onclick="selectWork(4)">4</div>
            <div class="map-marker" style="top: 25%; left: 65%;" data-work-id="5" onclick="selectWork(5)">5</div>

            <!-- Map Controls -->
            <div class="map-controls">
                <button class="map-control-btn" onclick="zoomIn()" title="ÌôïÎåÄ">+</button>
                <button class="map-control-btn" onclick="zoomOut()" title="Ï∂ïÏÜå">‚àí</button>
                <button class="map-control-btn" onclick="getCurrentLocation()" title="ÎÇ¥ ÏúÑÏπò">üìç</button>
                <button class="map-control-btn" onclick="toggleDistanceRings()" title="Í±∞Î¶¨ ÌëúÏãú">üéØ</button>
            </div>

            <!-- Map Legend -->
            <div class="map-legend">
                <div class="legend-item">
                    <div class="legend-marker" style="background: #2d5a27;"></div>
                    <span>ÏùºÎ∞ò ÏûëÏóÖ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-marker" style="background: #dc3545;"></div>
                    <span>Í∏¥Í∏â ÏûëÏóÖ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-marker" style="background: #ffc107;"></div>
                    <span>ÏÑ†ÌÉùÎêú ÏûëÏóÖ</span>
                </div>
            </div>

            <!-- Work Popup -->
            <div class="work-popup" id="workPopup">
                <div class="popup-header">
                    <div class="popup-title" id="popupTitle"></div>
                    <button class="close-popup" onclick="closePopup()">&times;</button>
                </div>
                <div class="popup-content" id="popupContent"></div>
                <div class="popup-meta" id="popupMeta"></div>
                <div class="popup-actions">
                    <button class="btn btn-outline btn-small" onclick="viewDetails()">ÏÉÅÏÑ∏Î≥¥Í∏∞</button>
                    <button class="btn btn-primary btn-small" onclick="applyWork()">ÏßÄÏõêÌïòÍ∏∞</button>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="sidebar-header">
                <div class="results-count">üìç Ï†ÑÎ∂Å Ï†ÑÏ£ºÏãú Í∏∞Ï§Ä <strong>12</strong>Í∞ú ÏûëÏóÖ</div>
                <div class="sort-options">
                    <button class="sort-btn active" data-sort="distance">Í±∞Î¶¨Ïàú</button>
                    <button class="sort-btn" data-sort="recent">ÏµúÏã†Ïàú</button>
                    <button class="sort-btn" data-sort="pay">Í∏âÏó¨Ïàú</button>
                </div>
            </div>
            <div class="work-list" id="workList">
                <!-- ÏûëÏóÖ Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <script>
        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞
        const sampleWorks = [
            {
                id: 1,
                title: "Î≤º ÏàòÌôï ÏûëÏóÖ (ÏΩ§Î∞îÏù∏ Î≥¥Ïú†Ïûê Ïö∞ÎåÄ)",
                description: "ÏïΩ 3ÎßåÌèâ Í∑úÎ™®Ïùò Î≤ºÎÖºÏóêÏÑú ÏàòÌôï ÏûëÏóÖÏùÑ ÏßÑÌñâÌï©ÎãàÎã§. ÏΩ§Î∞îÏù∏ÏùÑ Î≥¥Ïú†ÌïòÏã† Î∂ÑÏùÑ Ïö∞ÎåÄÌï©ÎãàÎã§.",
                category: "ÎÖºÎÜçÏÇ¨",
                price: "180,000",
                priceType: "ÏùºÎãπ",
                location: "Ï†ÑÎ∂Å ÏôÑÏ£ºÍµ∞ Í≥†ÏÇ∞Î©¥",
                distance: 2.1,
                date: "ÎÇ¥Ïùº",
                time: "Ïò§Ï†Ñ 6Ïãú",
                urgent: true,
                employer: "ÍπÄÎÜçÎ∂Ä",
                lat: 35.8563,
                lng: 127.1345
            },
            {
                id: 2,
                title: "Îî∏Í∏∞Î∞≠ Ï†ïÎ¶¨ Î∞è Î™®Ï¢Ö Ïã¨Í∏∞",
                description: "Í≤®Ïö∏Ï≤† Îî∏Í∏∞ Ïû¨Î∞∞Î•º ÏúÑÌïú Î∞≠ Ï†ïÎ¶¨ÏôÄ Î™®Ï¢Ö Ïã¨Í∏∞ ÏûëÏóÖÏûÖÎãàÎã§.",
                category: "Î∞≠ÎÜçÏÇ¨",
                price: "15,000",
                priceType: "ÏãúÍ∏â",
                location: "Ï†ÑÎ∂Å Ï†ÑÏ£ºÏãú ÎçïÏßÑÍµ¨",
                distance: 5.2,
                date: "3Ïùº ÌõÑ",
                time: "Ïò§ÌõÑ 1Ïãú",
                urgent: false,
                employer: "Ïù¥ÎÜçÏû•",
                lat: 35.8242,
                lng: 127.1480
            },
            {
                id: 3,
                title: "Ï∂ïÏÇ¨ Ï≤≠ÏÜå Î∞è ÏÇ¨Î£å Î∞∞Í∏â",
                description: "ÌïúÏö∞ 60Îëê Í∑úÎ™® Ï∂ïÏÇ¨Ïùò ÏùºÏùº Í¥ÄÎ¶¨ ÏóÖÎ¨¥ÏûÖÎãàÎã§.",
                category: "Ï∂ïÏÇ∞ÏóÖ",
                price: "120,000",
                priceType: "ÏùºÎãπ",
                location: "Ï†ÑÎ∂Å ÏßÑÏïàÍµ∞ ÎßàÎ†πÎ©¥",
                distance: 8.7,
                date: "1Ï£ºÏùº ÌõÑ",
                time: "Ïò§Ï†Ñ 7Ïãú",
                urgent: false,
                employer: "Î∞ïÎ™©Ïû•",
                lat: 35.7912,
                lng: 127.4234
            },
            {
                id: 4,
                title: "ÏÇ¨Í≥º ÏàòÌôï ÎèÑÏö∞ÎØ∏ (Í∏¥Í∏â)",
                description: "ÏÇ¨Í≥º ÏàòÌôïÏ≤†ÏùÑ ÎßûÏïÑ Í≥ºÏàòÏõêÏóêÏÑú ÏÇ¨Í≥º Îî∞Í∏∞ ÏûëÏóÖÏùÑ ÎèÑÏôÄÏ£ºÏã§ Î∂ÑÏùÑ Ï∞æÏäµÎãàÎã§.",
                category: "Í≥ºÏàòÏõê",
                price: "13,000",
                priceType: "ÏãúÍ∏â",
                location: "Ï†ÑÎ∂Å ÏûÑÏã§Íµ∞ Í¥ÄÏ¥åÎ©¥",
                distance: 12.3,
                date: "Ïù¥Î≤à Ï£ºÎßê",
                time: "Ïò§Ï†Ñ 8Ïãú",
                urgent: true,
                employer: "ÏµúÍ≥ºÏàòÏõê",
                lat: 35.6123,
                lng: 127.2891
            },
            {
                id: 5,
                title: "ÎπÑÎãêÌïòÏö∞Ïä§ Î≥¥Ïàò ÏûëÏóÖ",
                description: "Í≤®Ïö∏Ï≤† ÎåÄÎπÑ ÎπÑÎãêÌïòÏö∞Ïä§ Î≥¥Ïàò ÏûëÏóÖÏûÖÎãàÎã§.",
                category: "ÏãúÏÑ§Í¥ÄÎ¶¨",
                price: "200,000",
                priceType: "Ï¥ùÏï°",
                location: "Ï†ÑÎ∂Å Î¨¥Ï£ºÍµ∞ ÏÑ§Ï≤úÎ©¥",
                distance: 15.8,
                date: "ÌòëÏùò",
                time: "ÌòëÏùò",
                urgent: false,
                employer: "Ï†ïÎÜçÏõê",
                lat: 36.0134,
                lng: 127.6612
            }
        ];

        let selectedWorkId = null;
        let currentFilter = '5km';
        let currentSort = 'distance';

        // ÏûëÏóÖ Î™©Î°ù Î†åÎçîÎßÅ
        function renderWorkList(works) {
            const container = document.getElementById('workList');
            
            container.innerHTML = works.map(work => `
                <div class="work-item ${selectedWorkId === work.id ? 'selected' : ''}" 
                     onclick="selectWork(${work.id})" data-work-id="${work.id}">
                    ${work.urgent ? '<div class="urgent-badge">Í∏¥Í∏â</div>' : ''}
                    
                    <div class="work-header">
                        <div class="work-title">${work.title}</div>
                        <div class="work-distance">${work.distance}km</div>
                    </div>
                    
                    <div class="work-meta">
                        <div class="meta-item">üìç ${work.location}</div>
                        <div class="meta-item">üìÖ ${work.date}</div>
                    </div>
                    
                    <div class="work-meta">
                        <div class="work-price">${parseInt(work.price).toLocaleString()}Ïõê ${work.priceType}</div>
                        <div class="work-category">${work.category}</div>
                    </div>
                </div>
            `).join('');
            
            // Í≤∞Í≥º Ïàò ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelector('.results-count').innerHTML = 
                `üìç Ï†ÑÎ∂Å Ï†ÑÏ£ºÏãú Í∏∞Ï§Ä <strong>${works.length}</strong>Í∞ú ÏûëÏóÖ`;
        }

        // ÏûëÏóÖ ÏÑ†ÌÉù
        function selectWork(workId) {
            selectedWorkId = workId;
            const work = sampleWorks.find(w => w.id === workId);
            
            if (!work) return;
            
            // ÏßÄÎèÑ ÎßàÏª§ ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.map-marker').forEach(marker => {
                marker.classList.remove('selected');
            });
            
            const selectedMarker = document.querySelector(`[data-work-id="${workId}"]`);
            if (selectedMarker) {
                selectedMarker.classList.add('selected');
                showWorkPopup(work, selectedMarker);
            }
            
            // ÏÇ¨Ïù¥ÎìúÎ∞î ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.work-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            const selectedItem = document.querySelector(`.work-item[data-work-id="${workId}"]`);
            if (selectedItem) {
                selectedItem.classList.add('selected');
                selectedItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // ÏûëÏóÖ ÌåùÏóÖ ÌëúÏãú
        function showWorkPopup(work, marker) {
            const popup = document.getElementById('workPopup');
            const rect = marker.getBoundingClientRect();
            const mapRect = document.getElementById('mapContainer').getBoundingClientRect();
            
            // ÌåùÏóÖ ÎÇ¥Ïö© ÏÑ§Ï†ï
            document.getElementById('popupTitle').textContent = work.title;
            document.getElementById('popupContent').textContent = work.description;
            document.getElementById('popupMeta').innerHTML = `
                <div><strong>ÏúÑÏπò:</strong> ${work.location}</div>
                <div><strong>Í∏âÏó¨:</strong> ${work.price.toLocaleString()}Ïõê ${work.priceType}</div>
                <div><strong>ÏùºÏ†ï:</strong> ${work.date} ${work.time}</div>
                <div><strong>ÏùòÎ¢∞Ïûê:</strong> ${work.employer}</div>
            `;
            
            // ÌåùÏóÖ ÏúÑÏπò ÏÑ§Ï†ï
            const popupX = rect.left - mapRect.left;
            const popupY = rect.top - mapRect.top;
            
            popup.style.left = popupX + 'px';
            popup.style.top = popupY + 'px';
            popup.classList.add('show');
        }

        // ÌåùÏóÖ Îã´Í∏∞
        function closePopup() {
            document.getElementById('workPopup').classList.remove('show');
            selectedWorkId = null;
            
            // ÏÑ†ÌÉù ÏÉÅÌÉú Ìï¥Ï†ú
            document.querySelectorAll('.map-marker, .work-item').forEach(el => {
                el.classList.remove('selected');
            });
        }

        // ÌïÑÌÑ∞ÎßÅ
        function filterWorks() {
            let filtered = [...sampleWorks];
            
            // Í±∞Î¶¨ ÌïÑÌÑ∞
            if (currentFilter === '5km') {
                filtered = filtered.filter(work => work.distance <= 5);
            } else if (currentFilter === 'urgent') {
                filtered = filtered.filter(work => work.urgent);
            } else if (currentFilter === 'high-pay') {
                filtered = filtered.filter(work => parseInt(work.price) >= 100000);
            } else if (currentFilter === 'today') {
                filtered = filtered.filter(work => work.date === 'ÎÇ¥Ïùº' || work.date === 'Ïò§Îäò');
            }
            
            return filtered;
        }

        // Ï†ïÎ†¨
        function sortWorks(works) {
            const sorted = [...works];
            
            switch(currentSort) {
                case 'distance':
                    return sorted.sort((a, b) => a.distance - b.distance);
                case 'recent':
                    return sorted.sort((a, b) => a.id - b.id);
                case 'pay':
                    return sorted.sort((a, b) => parseInt(b.price) - parseInt(a.price));
                default:
                    return sorted;
            }
        }

        // ÏûëÏóÖ Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
        function updateWorkList() {
            const filtered = filterWorks();
            const sorted = sortWorks(filtered);
            renderWorkList(sorted);
            updateMapMarkers(sorted);
        }

        // ÏßÄÎèÑ ÎßàÏª§ ÏóÖÎç∞Ïù¥Ìä∏
        function updateMapMarkers(works) {
            // Î™®Îì† ÎßàÏª§ Ïà®Í∏∞Í∏∞
            document.querySelectorAll('.map-marker').forEach(marker => {
                const workId = parseInt(marker.dataset.workId);
                const shouldShow = works.some(work => work.id === workId);
                marker.style.display = shouldShow ? 'flex' : 'none';
            });
        }

        // ÌòÑÏû¨ ÏúÑÏπò Í∞ÄÏ†∏Ïò§Í∏∞
        function getCurrentLocation() {
            if (navigator.geolocation) {
                document.querySelector('.location-btn').textContent = 'üîÑ ÏúÑÏπò ÌôïÏù∏Ï§ë...';
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        // Í±∞Î¶¨ Ïû¨Í≥ÑÏÇ∞ (Ïã§Ï†ú ÏÑúÎπÑÏä§ÏóêÏÑúÎäî ÏÑúÎ≤ÑÏóêÏÑú Í≥ÑÏÇ∞)
                        alert(`ÌòÑÏû¨ ÏúÑÏπò: ${lat.toFixed(4)}, ${lng.toFixed(4)}\nÍ±∞Î¶¨ Í∏∞Ï§ÄÏúºÎ°ú ÏûëÏóÖÏùÑ Îã§Ïãú Ï†ïÎ†¨Ìï©ÎãàÎã§.`);
                        
                        document.querySelector('.location-btn').textContent = 'üìç ÎÇ¥ ÏúÑÏπò';
                        updateWorkList();
                    },
                    (error) => {
                        alert('ÏúÑÏπò Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.');
                        document.querySelector('.location-btn').textContent = 'üìç ÎÇ¥ ÏúÑÏπò';
                    }
                );
            } else {
                alert('Ïù¥ Î∏åÎùºÏö∞Ï†ÄÎäî ÏúÑÏπò ÏÑúÎπÑÏä§Î•º ÏßÄÏõêÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
            }
        }

        // Í±∞Î¶¨ ÎßÅ ÌÜ†Í∏Ä
        function toggleDistanceRings() {
            const rings = document.querySelectorAll('.distance-ring');
            rings.forEach(ring => {
                ring.style.display = ring.style.display === 'none' ? 'block' : 'none';
            });
        }

        // ÏßÄÎèÑ Ï§å
        function zoomIn() {
            alert('ÏßÄÎèÑ ÌôïÎåÄ (ÏßÄÎèÑ API Ïó∞Îèô ÌïÑÏöî)');
        }

        function zoomOut() {
            alert('ÏßÄÎèÑ Ï∂ïÏÜå (ÏßÄÎèÑ API Ïó∞Îèô ÌïÑÏöî)');
        }

        // Î∑∞ Ï†ÑÌôò
        function switchToList() {
            alert('Î™©Î°ù Î≥¥Í∏∞Î°ú Ï†ÑÌôòÌï©ÎãàÎã§.');
            // window.location.href = 'DG-work-list.html';
        }

        function switchToMap() {
            // Ïù¥ÎØ∏ ÏßÄÎèÑ Î∑∞
        }

        // ÏûëÏóÖ ÏÉÅÏÑ∏Î≥¥Í∏∞
        function viewDetails() {
            if (selectedWorkId) {
                alert(`ÏûëÏóÖ ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§. (ID: ${selectedWorkId})`);
                // window.location.href = `DG-work-detail.html?id=${selectedWorkId}`;
            }
        }

        // ÏûëÏóÖ ÏßÄÏõê
        function applyWork() {
            if (selectedWorkId) {
                alert('ÏûëÏóÖÏóê ÏßÄÏõêÌñàÏäµÎãàÎã§!');
                closePopup();
            }
        }

        // Îí§Î°úÍ∞ÄÍ∏∞
        function goBack() {
            window.history.back();
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
        document.addEventListener('DOMContentLoaded', function() {
            // Ï¥àÍ∏∞ Î†åÎçîÎßÅ
            updateWorkList();
            
            // ÌïÑÌÑ∞ ÌÉúÍ∑∏ ÌÅ¥Î¶≠
            document.querySelectorAll('.filter-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    if (this.dataset.filter === 'all') {
                        currentFilter = '';
                    } else {
                        currentFilter = this.dataset.filter;
                    }
                    
                    document.querySelectorAll('.filter-tag').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    updateWorkList();
                });
            });
            
            // Ï†ïÎ†¨ Î≤ÑÌäº ÌÅ¥Î¶≠
            document.querySelectorAll('.sort-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    currentSort = this.dataset.sort;
                    
                    document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    updateWorkList();
                });
            });
            
            // Í≤ÄÏÉâ ÏûÖÎ†•
            document.getElementById('searchInput').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                if (searchTerm) {
                    // Ïã§Ï†ú ÏÑúÎπÑÏä§ÏóêÏÑúÎäî API Ìò∏Ï∂ú
                    console.log('Í≤ÄÏÉâÏñ¥:', searchTerm);
                }
            });
            
            // ÏßÄÎèÑ ÌÅ¥Î¶≠ÏúºÎ°ú ÌåùÏóÖ Îã´Í∏∞
            document.getElementById('mapContainer').addEventListener('click', function(e) {
                if (e.target === this || e.target.classList.contains('map-placeholder')) {
                    closePopup();
                }
            });
            
            // ESC ÌÇ§Î°ú ÌåùÏóÖ Îã´Í∏∞
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closePopup();
                }
            });
        });

        // Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏ ÏãúÎÆ¨Î†àÏù¥ÏÖò
        function simulateRealTimeUpdates() {
            // ÏÉà ÏûëÏóÖ Ï∂îÍ∞Ä
            if (Math.random() > 0.9) {
                const newWork = {
                    id: Date.now(),
                    title: "ÏÉàÎ°úÏö¥ ÎÜçÏûëÏóÖ ÏùòÎ¢∞",
                    description: "Î∞©Í∏à Îì±Î°ùÎêú ÏÉàÎ°úÏö¥ ÏûëÏóÖÏûÖÎãàÎã§.",
                    category: "Í∏∞ÌÉÄ",
                    price: "80000",
                    priceType: "ÏùºÎãπ",
                    location: "Ï†ÑÎ∂Å Ï†ÑÏ£ºÏãú ÏôÑÏÇ∞Íµ¨",
                    distance: Math.random() * 20,
                    date: "ÎÇ¥Ïùº",
                    time: "Ïò§Ï†Ñ 9Ïãú",
                    urgent: Math.random() > 0.7,
                    employer: "Ïã†Í∑úÎÜçÏû•",
                    lat: 35.8 + Math.random() * 0.1,
                    lng: 127.1 + Math.random() * 0.1
                };
                
                sampleWorks.push(newWork);
                updateWorkList();
                
                // ÏÉà ÎßàÏª§ Ï∂îÍ∞Ä (Ïã§Ï†úÎ°úÎäî ÏßÄÎèÑ APIÎ•º ÌÜµÌï¥)
                console.log('ÏÉà ÏûëÏóÖÏù¥ ÏßÄÎèÑÏóê Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§:', newWork.title);
            }
        }

        // ÏßÄÎèÑ Ï¥àÍ∏∞Ìôî ÏãúÎÆ¨Î†àÏù¥ÏÖò
        function initializeMap() {
            console.log('ÏßÄÎèÑ Ï¥àÍ∏∞Ìôî Ï§ë...');
            
            // Ïã§Ï†ú ÏÑúÎπÑÏä§ÏóêÏÑúÎäî Ïó¨Í∏∞Ïóê Ïπ¥Ïπ¥Ïò§Îßµ ÎòêÎäî ÎÑ§Ïù¥Î≤ÑÏßÄÎèÑ Ï¥àÍ∏∞Ìôî ÏΩîÎìú
            // Ïòà: new kakao.maps.Map(...);
            
            setTimeout(() => {
                console.log('ÏßÄÎèÑ Î°úÎî© ÏôÑÎ£å');
            }, 1000);
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏßÄÎèÑ Ï¥àÍ∏∞Ìôî
        window.addEventListener('load', initializeMap);

        // 10Ï¥àÎßàÎã§ Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
        setInterval(simulateRealTimeUpdates, 10000);

        // Î¶¨ÏÇ¨Ïù¥Ï¶à Ïù¥Î≤§Ìä∏ Ï≤òÎ¶¨
        window.addEventListener('resize', function() {
            closePopup(); // ÌåùÏóÖÏù¥ Ïó¥Î†§ÏûàÏúºÎ©¥ Îã´Í∏∞
        });
    </script>
</body>
</html>